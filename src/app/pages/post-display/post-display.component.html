<div class="container-fluid">
  <button
    mat-raised-button
    class="back-button"
    [routerLink]="['/post']"
    color="primary"
    i18n
  >
    <em class="material-icons">arrow_back</em> Back to posts.
  </button>
  <div *ngIf="loading; else display"></div>
  <button
    mat-raised-button
    class="back-button"
    [routerLink]="['/post']"
    color="primary"
    i18n
  >
    <em class="material-icons">arrow_back</em> Back to posts.
  </button>
</div>
<app-top-scroller></app-top-scroller>

<ng-template #display>
  <div [class]="getGameClass()">
    <div class="row">
      <div class="col-lg-10">

        <mat-card class="mat-elevation-z10 mt-1">
          <mat-card-header>
            <mat-card-title>{{ post.title }}</mat-card-title>
            <mat-card-subtitle class="mouse-pointer" (click)="viewAuthor()">
              Written by {{post.author.name}}
            </mat-card-subtitle>
            <mat-card-subtitle>{{ post.game.name }}</mat-card-subtitle>
            <h5 class="subtitle" *ngIf="post.isPrivate" i18n>
              <em class="material-icons">lock</em> This is a private
              post, only you can see it.
            </h5>
          </mat-card-header>
          <mat-card-content>
            <hr/>
            <div [innerHTML]="bodyHtml"></div>
          </mat-card-content>
          <mat-card-actions>
            <app-like-button
            [postId]="post.id"
            [likes]="post.likes"
            [liked]="post.liked"
          >
          </app-like-button>

          <div class="d-inline p-1" *ngIf="isPostFromUser()">
            <button (click)="editPost()" mat-raised-button color="accent" i18n>
              <em class="material-icons">edit</em> Edit
            </button>

            <button
              (click)="downloadPost()"
              mat-raised-button
              color="accent"
              i18n
              class="ml-2"
            >
              <em class="material-icons">cloud_download</em> Download Markdown
            </button>
          </div>
          </mat-card-actions>
        </mat-card>
      </div>
      <div class="col-lg-2">
        <mat-card class="mat-elevation-z10">
          <mat-card-header>
            <mat-card-title i18n>Featured in this post.</mat-card-title>
          </mat-card-header>
          <mat-card-content>
            <mat-card class="mb-2">
              <mat-card-header>
                <mat-card-title>
                  {{ post.author.name }}
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                  A small text about the author of this post.
              </mat-card-content>
            </mat-card>
            <mat-card class="mb-2">
              <mat-card-header>
                <mat-card-title>
                  {{ post.game.name }}
                </mat-card-title>
              </mat-card-header>
              <mat-card-content>
                <p class="description">
                  {{ post.game.description }}
                </p>
                <button
                class="view-button"
                mat-raised-button
                color="primary"
                (click)="viewGame(post.game.id)"
                i18n
              >
                View
              </button>
              </mat-card-content>
            </mat-card>
            <mat-card *ngIf="post.character" class="mb-2">
              <mat-card-header>
                <mat-card-title>
                  {{ post.character.name }}
                </mat-card-title>
                <div mat-card-avatar>
                  <img
                  alt="Character stock icon"
                  class="fit-image-height"
                  [src]="post.character.stockIcon.url"
                />
                </div>
              </mat-card-header>
              <mat-card-content>
                <p class="description">
                  {{ post.character.generalInformation }}
                </p>
                <button
                class="view-button"
                mat-raised-button
                color="primary"
                (click)="viewCharacter(post.character.id)"
                i18n
              >
                View
              </button>
              </mat-card-content>
            </mat-card>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>
</ng-template>
